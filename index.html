<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>12 Card Ranking - Smooth Drag</title>
<style>
:root {
  /* dark theme (default) */
  --bg-dark: oklch(0.1 0.04 234);
  --bg: oklch(0.15 0.04 234);
  --bg-light: oklch(0.2 0.04 234);
  --text: oklch(0.96 0.08 234);
  --text-muted: oklch(0.76 0.08 234);
  --highlight: oklch(0.5 0.08 234);
  --border: oklch(0.4 0.08 234);
  --border-muted: oklch(0.3 0.08 234);
  --primary: oklch(0.76 0.1 234);
  --secondary: oklch(0.76 0.1 54);
  --danger: oklch(0.7 0.08 30);
  --warning: oklch(0.7 0.08 100);
  --success: oklch(0.7 0.08 160);
  --info: oklch(0.7 0.08 260);
}

body.light {
  --bg-dark: oklch(0.92 0.04 234);
  --bg: oklch(0.96 0.04 234);
  --bg-light: oklch(1 0.04 234);
  --text: oklch(0.15 0.08 234);
  --text-muted: oklch(0.4 0.08 234);
  --highlight: oklch(1 0.08 234);
  --border: oklch(0.6 0.08 234);
  --border-muted: oklch(0.7 0.08 234);
  --primary: oklch(0.4 0.1 234);
  --secondary: oklch(0.4 0.1 54);
  --danger: oklch(0.5 0.08 30);
  --warning: oklch(0.5 0.08 100);
  --success: oklch(0.5 0.08 160);
  --info: oklch(0.5 0.08 260);
}

body {
  font-family: Arial, sans-serif;
  background: var(--bg);
  color: var(--text);
  padding: 40px;
  user-select: none;
  transition: background 0.3s, color 0.3s;
}

h1 {
  margin-bottom: 10px;
  color: var(--text);
}

p {
  color: var(--text-muted);
}

#themeToggle {
  padding: 10px 20px;
  margin-bottom: 20px;
  border: none;
  border-radius: 8px;
  cursor: pointer;
  font-weight: bold;
  transition: background 0.3s, color 0.3s;
  background: var(--primary);
  color: var(--text);
}

body.light #themeToggle {
  background: var(--bg-light);
  color: var(--text);
}

#themeToggle:hover {
  background: var(--highlight);
}

.card-container {
  display: flex;
  flex-direction: column;
  gap: 15px;
  max-width: 400px;
  position: relative;
}

.card {
  position: relative;
  padding: 20px;
  border-radius: 12px;
  background: var(--bg-light);
  box-shadow: 0 3px 8px rgba(0,0,0,0.08);
  transition: transform 0.2s ease;
}

.card h3 {
  color: var(--text);
  margin: 0 0 5px 0;
}

.card p {
  color: var(--text-muted);
  margin: 0;
}

.rank {
  position: absolute;
  top: 10px;
  right: 15px;
  font-weight: bold;
  font-size: 18px;
  background: var(--highlight);
  color: var(--text);
  padding: 4px 8px;
  border-radius: 8px;
}

.dragging {
  position: absolute;
  z-index: 1000;
  pointer-events: none;
  opacity: 0.95;
  width: 400px;
  box-shadow: 0 15px 25px rgba(0,0,0,0.25);
  transition: none;
}
</style>
</head>
<body>

<button id="themeToggle">Toggle Theme</button>

<h1>Rank These Items</h1>
<p>Drag to reorder. 1 = Most Important.</p>

<div class="card-container" id="cardContainer">
  <div class="card"><div class="rank"></div><h3>Card 1</h3><p>I don’t know what to put here!</p></div>
  <div class="card"><div class="rank"></div><h3>Card 2</h3><p>Description text here.</p></div>
  <div class="card"><div class="rank"></div><h3>Card 3</h3><p>Description text here.</p></div>
  <div class="card"><div class="rank"></div><h3>Card 4</h3><p>Description text here.</p></div>
  <div class="card"><div class="rank"></div><h3>Card 5</h3><p>What’s this for?</p></div>
  <div class="card"><div class="rank"></div><h3>Card 6</h3><p>Description text here.</p></div>
  <div class="card"><div class="rank"></div><h3>Card 7</h3><p>Description text here.</p></div>
  <div class="card"><div class="rank"></div><h3>Card 8</h3><p>Hi!!!!</p></div>
  <div class="card"><div class="rank"></div><h3>Card 9</h3><p>Description text here.</p></div>
  <div class="card"><div class="rank"></div><h3>Card 10</h3><p>Description text here.</p></div>
  <div class="card"><div class="rank"></div><h3>Card 11</h3><p>Description text here.</p></div>
  <div class="card"><div class="rank"></div><h3>Card 12</h3><p>Description text here.</p></div>
</div>

<script>
// 1️⃣ Theme detection & toggle
const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
if (!prefersDark) document.body.classList.add('light');

const toggleBtn = document.getElementById('themeToggle');
toggleBtn.addEventListener('click', () => {
  document.body.classList.toggle('light');
});

// 2️⃣ Drag-and-drop logic (with scroll fix)
const container = document.getElementById('cardContainer');
let dragged = null;
let mouseOffsetY = 0;
let placeholderIndex = 0;

function updateRanks() {
  container.querySelectorAll('.card').forEach((card, i) => {
    card.querySelector('.rank').textContent = i + 1;
  });
}

updateRanks();

container.querySelectorAll('.card').forEach(card => {
  card.addEventListener('mousedown', e => {
    dragged = card;
    const rect = card.getBoundingClientRect();
    mouseOffsetY = e.clientY - rect.top;

    dragged.style.width = `${rect.width}px`;
    dragged.style.height = `${rect.height}px`;
    dragged.classList.add('dragging');

    document.body.appendChild(dragged);
  });
});

document.addEventListener('mousemove', e => {
  if (!dragged) return;

  dragged.style.top = `${e.clientY + window.scrollY - mouseOffsetY}px`;
  dragged.style.left = `${container.getBoundingClientRect().left}px`;

  const cards = Array.from(container.children);
  cards.forEach((c, index) => {
    const rect = c.getBoundingClientRect();
    const middle = rect.top + rect.height / 2;
    let transformY = 0;

    if (e.clientY + window.scrollY < middle && index < cards.indexOf(dragged)) transformY = rect.height + 15;
    if (e.clientY + window.scrollY > middle && index > cards.indexOf(dragged)) transformY = - (rect.height + 15);

    const current = parseFloat(c.style.transform.replace(/translateY\((.*)px\)/, '$1')) || 0;
    c.style.transform = `translateY(${current + (transformY - current) * 0.2}px)`;
  });

  const cardRects = cards.map(c => c.getBoundingClientRect());
  placeholderIndex = cardRects.findIndex(r => e.clientY + window.scrollY < r.top + r.height / 2);
  if (placeholderIndex === -1) placeholderIndex = cards.length;
});

document.addEventListener('mouseup', () => {
  if (!dragged) return;

  const children = Array.from(container.children);
  container.insertBefore(dragged, children[placeholderIndex] || null);

  dragged.classList.remove('dragging');
  dragged.style.position = '';
  dragged.style.width = '';
  dragged.style.height = '';
  dragged.style.top = '';
  dragged.style.left = '';
  dragged.style.transform = '';

  container.querySelectorAll('.card').forEach(c => c.style.transform = '');
  dragged = null;
  updateRanks();
});
</script>

</body>
</html>
